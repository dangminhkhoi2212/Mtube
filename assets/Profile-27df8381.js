import{_ as S,x as L,K as A,L as U,B as u,f as v,g as l,m as a,z as r,y as g,s as e,j as y,F as E,q as P,l as _,k as b,T as j,G as h,M as f,u as I,t as p,C,D as R,E as B}from"./index-36a60a37.js";import{V as z}from"./VideoCard-ff756b34.js";import{c as k,a as M}from"./Artplayer-e114ec4f.js";import{a as d}from"./myAlert-34166312.js";import{d as T}from"./ChatEngine-4af0407b.js";import{P as N}from"./ProfileCard-131b0e33.js";const O={setup(){return{accountStore:L()}},props:{accountId:{type:String}},components:{AvatarCircle:A,VideoCard:z,Loading:U,ProfileCard:N},data(){return{account:{},option:{},style:{width:"100%",height:"180px",borderRadius:"var(--border_radius_video)"},newCover:null,coverUrl:"",oldCoverUrl:"",navFields:["Videos","About","Settings"],activeField:this.$route.query.chooseField||"Videos",totalFollowers:[],joined:"",password:null,isEditDetails:!1,isUpdateCover:!1,isDeleteAccount:!1,isProfile:this.accountId===this.accountStore.account._id,loading:{isLoading:!0,isfullPage:!1,onCancel:!1}}},watch:{},methods:{async getProfile(){try{this.account=await u.getAccount(this.accountId),this.coverUrl=this.account.cover.url,this.oldCoverUrl=this.account.cover.url,this.totalFollowers=this.account.followers,this.formatDateVideo(),this.formatJoined()}catch(s){console.log("ðŸš€ ~ file: Profile.vue:31 ~ getProfile ~ error:",s)}},formatDateVideo(){this.account.myVideos=this.account.myVideos.map(s=>(s.publishedAt=k(s.publishedAt),s))},formatJoined(){this.joined=`${M(this.account.join)}, ${k(this.account.join)}`},getTotalViews(){if(this.account.myVideos.length>0){var s=0;return this.account.myVideos.forEach(o=>{s+=o.viewCount}),s}return 0},async handleFollow(s){try{const o=this.accountStore.account._id,m=this.accountId;o!==m&&(this.account=await u.handleFollow(o,m,s),this.totalFollowers=this.account.followers,this.formatDateVideo())}catch(o){console.log("ðŸš€ ~ file: Profile.vue:192 ~ follow ~ error:",o)}},async removeMyVideo(s){if(await d.myConfirm("Are you sure?","warning","You won't be able to revert this!","Yes, delete it!"))try{this.loading.isLoading=!0,this.account=await u.removeMyVideo(this.accountStore.account._id,s),this.formatDateVideo(),d.myAlert("success","Your video has been deleted."),this.loading.isLoading=!1}catch{d.myAlert("Error!","Don't delete this video! "),this.loading.isLoading=!1}},async handleEditDetails(){try{this.isEditDetails=!0,this.loading.isLoading=!0;const{biography:s,media:o}=this.account;this.account=await u.update(this.account._id,{biography:s,media:o}),this.formatDateVideo(),d.myAlert("success","Your video has been deleted."),this.isEditDetails=!1,this.loading.isLoading=!1}catch{this.loading.isLoading=!1,d.myAlert("error","Don't update detail this video! ")}},handleButtonClick(){this.$refs.file.click(),this.isUpdateCover=!0},onFileSelected(s){s.target.files[0]&&(this.newCover=s.target.files[0],URL.revokeObjectURL(this.newCover),this.coverUrl=URL.createObjectURL(s.target.files[0]))},handleCancelFile(){this.isUpdateCover=!1,this.coverUrl=this.oldCoverUrl},async updateCover(){try{this.loading.isLoading=!0,this.isUpdateCover=!1;const s=new FormData;s.append("image",this.newCover),s.append("selectImage","cover"),this.account=await u.update(this.accountStore.account._id,s),this.formatDateVideo(),URL.revokeObjectURL(this.coverUrl),this.loading.isLoading=!1}catch{this.loading.isLoading=!1,d.myAlert("error","Error while updating")}},changeNavFields(s){this.activeField=s},async deleteAccount(){try{if(this.isDeleteAccount&&!this.password)return;this.loading.isLoading=!0,await u.delete(this.accountStore.account._id,this.password),await T(this.accountStore.account.username,this.accountStore.account._id),this.accountStore.account=null,localStorage.clear(),this.loading.isLoading=!1,this.$router.push({name:"login"})}catch(s){this.loading.isLoading=!1,d.myAlert("error",s.response.data.message)}}},async created(){await this.getProfile(),this.loading.isLoading=!1},async mounted(){if(this.chooseField&&(this.activeField=this.chooseField),!this.isProfile){let s=this.navFields.indexOf("Setting");this.navFields=this.navFields.splice(0,s)}}},n=s=>(R("data-v-a369d4c1"),s=s(),B(),s),Y={key:0,class:"px-md-5 vl-parent position-relative"},q={class:"position-absolute bottom-0 mb-2 px-2"},J=n(()=>e("i",{class:"fa-solid fa-camera"},null,-1)),G=[J],K={key:1,class:"position-absolute bottom-0 end-0"},H={class:"py-4"},Q={class:"d-flex flex-column sticky-top",style:{"background-color":"var(--background_main)","z-index":"calc(var(--z_index_nav) - 1)"}},W={class:"d-flex"},X=["onClick"],Z=n(()=>e("hr",{class:"m-0 p-0"},null,-1)),$={key:1},ee={class:"",key:2},te={class:"row row-cols-1 row-cols-md-3 py-3"},oe={class:"col"},se=n(()=>e("h5",null,"Joined",-1)),ie=n(()=>e("hr",null,null,-1)),ne={class:"col"},le=n(()=>e("h5",null,"Total views",-1)),ae=n(()=>e("hr",null,null,-1)),ce={class:"col"},re=n(()=>e("h5",null,"Following",-1)),de=n(()=>e("hr",null,null,-1)),ue={class:"row"},he=n(()=>e("h5",null,"Biography",-1)),fe=n(()=>e("hr",null,null,-1)),pe={class:"row"},me=n(()=>e("h5",null,"Media",-1)),ve={class:"d-flex flex-column flex-sm-row justify-content-around gap-3"},_e=["href"],ge=n(()=>e("i",{class:"fs-3 rounded-5 p-2 fa-brands fa-facebook"},null,-1)),ye=[ge],be=["href"],ke=n(()=>e("i",{class:"fs-3 rounded-5 p-2 fa-brands fa-instagram"},null,-1)),Ce=[ke],we=["href"],xe=n(()=>e("i",{class:"fs-3 rounded-5 p-2 fa-brands fa-tiktok"},null,-1)),De=[xe],Ve=n(()=>e("hr",{class:"my-2"},null,-1)),Fe={class:"d-flex justify-content-center gap-2 mt-4"},Se=n(()=>e("span",null,[e("i",{class:"fs-4 mx-2 fa-regular fa-pen-to-square"}),C("Edit details ")],-1)),Le=[Se],Ae=n(()=>e("span",null,[e("i",{class:"fs-4 mx-2 fa-solid fa-xmark"})],-1)),Ue=[Ae],Ee=n(()=>e("i",{class:"fs-4 mx-2 fa-solid fa-cloud-arrow-up"},null,-1)),Pe={key:3,class:"row col-12 col-sm-6"},je={class:"d-flex justify-content-between align-items-center py-2 mt-2"},Ie=n(()=>e("h5",null,"Edit Account",-1)),Re=n(()=>e("button",{class:"btn"},"Go to Edit",-1)),Be=n(()=>e("hr",null,null,-1)),ze={class:"d-flex justify-content-between align-items-center py-2"},Me=n(()=>e("h5",null,"Delete Account",-1)),Te=n(()=>e("hr",null,null,-1)),Ne={key:2,class:"d-flex flex-column align-items-center gap-3 position-absolute top-50 start-50 translate-middle p-5 rounded-3",style:{"background-color":"var(--violet_90)","z-index":"var(--z_index_nav)"}},Oe=n(()=>e("h5",null,"Confirm your password",-1)),Ye={class:"d-flex justify-content-center gap-4"};function qe(s,o,m,w,t,c){const x=v("ProfileCard"),D=v("VideoCard"),V=v("RouterLink"),F=v("Loading");return t.account&&w.accountStore.account?(l(),a("div",Y,[t.isDeleteAccount?(l(),a("div",{key:0,class:"space",onClick:o[0]||(o[0]=i=>t.isDeleteAccount=!t.isDeleteAccount)})):r("",!0),t.account.cover?(l(),a("div",{key:1,class:"px-md-5 position-relative",style:g([{height:"40vh"},{backgroundImage:`url(${t.coverUrl})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}])},[e("div",q,[t.account?(l(),y(x,{key:0,account:t.account},null,8,["account"])):r("",!0)]),!t.isUpdateCover&&t.isProfile?(l(),a("button",{key:0,class:"position-absolute bottom-0 end-0 p-3 rounded-3 m-3",style:{"background-color":"var(--btn)"},onClick:o[1]||(o[1]=(...i)=>c.handleButtonClick&&c.handleButtonClick(...i))},G)):r("",!0),t.isUpdateCover&&t.isProfile?(l(),a("div",K,[e("i",{role:"button",class:"p-3 rounded-3 fa-solid fa-xmark",style:{"background-color":"var(--btn)"},onClick:o[2]||(o[2]=(...i)=>c.handleCancelFile&&c.handleCancelFile(...i))}),e("i",{role:"button",class:"p-3 m-3 rounded-3 fa-solid fa-cloud-arrow-up",style:{"background-color":"var(--btn)"},onClick:o[3]||(o[3]=(...i)=>c.updateCover&&c.updateCover(...i))})])):r("",!0),e("input",{class:"d-none",type:"file",ref:"file",accept:"image/png, image/jpeg",onChange:o[4]||(o[4]=(...i)=>c.onFileSelected&&c.onFileSelected(...i)),onCancel:o[5]||(o[5]=(...i)=>c.handleCancelFile&&c.handleCancelFile(...i))},null,544)],4)):r("",!0),e("div",H,[e("div",Q,[e("div",W,[(l(!0),a(E,null,P(t.navFields,i=>(l(),a("div",{key:i},[e("div",{role:"button",class:I(["btn fs-5",{active_btn:t.activeField===i}]),onClick:Je=>c.changeNavFields(i)},p(i),11,X)]))),128))]),Z]),_(j,{name:"slide-fade"},{default:b(()=>[t.activeField==="Videos"?(l(),a("div",$,[(l(),y(D,{key:t.account.myVideos,class:"customArtplayer",videos:t.account.myVideos,style:g(t.style),option:t.option,onRemoveMyVideo:c.removeMyVideo},null,8,["videos","style","option","onRemoveMyVideo"]))])):t.activeField==="About"?(l(),a("div",ee,[e("div",te,[e("div",oe,[se,e("p",null,p(t.joined),1),ie]),e("div",ne,[le,e("p",null,p(c.getTotalViews()),1),ae]),e("div",ce,[re,e("p",null,p(t.account.following.length.toLocaleString("en-US")),1),de])]),e("div",ue,[he,t.isEditDetails?h((l(),a("textarea",{key:1,class:"p-2 my-2 mx-auto",style:{color:"var(--text)",height:"100px",width:"90%"},"onUpdate:modelValue":o[6]||(o[6]=i=>t.account.biography=i)},`\r
                        `,512)),[[f,t.account.biography]]):(l(),a("p",{key:t.account.biography},p(t.account.biography),1)),fe]),e("div",pe,[me,e("div",ve,[e("a",{target:"_blank",href:t.account.media.facebook},ye,8,_e),t.isEditDetails?h((l(),a("input",{key:0,type:"text","onUpdate:modelValue":o[7]||(o[7]=i=>t.account.media.facebook=i)},null,512)),[[f,t.account.media.facebook]]):r("",!0),e("a",{target:"_blank",href:t.account.media.instagram},Ce,8,be),t.isEditDetails?h((l(),a("input",{key:1,type:"text","onUpdate:modelValue":o[8]||(o[8]=i=>t.account.media.instagram=i)},null,512)),[[f,t.account.media.instagram]]):r("",!0),e("a",{target:"_blank",href:t.account.media.tiktok},De,8,we),t.isEditDetails?h((l(),a("input",{key:2,type:"text","onUpdate:modelValue":o[9]||(o[9]=i=>t.account.media.tiktok=i)},null,512)),[[f,t.account.media.tiktok]]):r("",!0)]),Ve]),e("div",Fe,[!t.isEditDetails&&t.isProfile?(l(),a("button",{key:0,class:"col-8 col-sm-4 px-2 py-1 rounded-3 text-center",onClick:o[10]||(o[10]=i=>t.isEditDetails=!0),style:{"background-color":"var(--btn)",color:"var(--text)"}},Le)):r("",!0),t.isEditDetails?(l(),a("button",{key:1,class:"rounded-2 text-center",onClick:o[11]||(o[11]=i=>t.isEditDetails=!1),style:{"background-color":"var(--btn)",color:"var(--text)"}},Ue)):r("",!0),t.isEditDetails?(l(),a("button",{key:2,class:"col-5 col-sm-2 px-2 py-1 rounded-3 text-center",onClick:o[12]||(o[12]=(...i)=>c.handleEditDetails&&c.handleEditDetails(...i)),style:{"background-color":"var(--btn)",color:"var(--text)"}},[Ee,C("Save ")])):r("",!0)])])):(l(),a("div",Pe,[e("div",je,[Ie,_(V,{to:{name:"editprofile"}},{default:b(()=>[Re]),_:1})]),Be,e("div",ze,[Me,e("button",{class:"btn",onClick:o[13]||(o[13]=i=>t.isDeleteAccount=!0)}," Delete ")]),Te]))]),_:1})]),t.isDeleteAccount?(l(),a("div",Ne,[Oe,h(e("input",{type:"password",class:"p-2","onUpdate:modelValue":o[14]||(o[14]=i=>t.password=i)},null,512),[[f,t.password]]),e("div",Ye,[e("button",{class:"btn",onClick:o[15]||(o[15]=i=>t.isDeleteAccount=!1)}," Cancle "),e("button",{class:"btn",onClick:o[16]||(o[16]=(...i)=>c.deleteAccount&&c.deleteAccount(...i))},"Delete")])])):r("",!0),_(F,{active:t.loading.isLoading,"onUpdate:active":o[17]||(o[17]=i=>t.loading.isLoading=i),"can-cancel":t.loading.onCancel,"is-full-page":t.loading.isfullPage,opacity:.5,backgroundColor:"#170f23 !important",color:"#c6bcd3",loader:"bars"},null,8,["active","can-cancel","is-full-page"])])):r("",!0)}const Ze=S(O,[["render",qe],["__scopeId","data-v-a369d4c1"]]);export{Ze as default};
